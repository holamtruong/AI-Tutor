import{d as L,r,a as M,o as O,u as $,b as o,k as U,e as t,g as d,w as Y,f as S,v as w,t as u,F as x,i as C,j as s,_ as q}from"./index-CblIsNI7.js";import{N as B}from"./Navbar-DwRIBrG9.js";import{h as K,V as I,R as N,g as P,S as G}from"./localStorage-gGBUY11W.js";const F={class:"dictionary-screen"},J={class:"dictionary-main"},W={class:"dictionary-grid"},j={class:"form__field"},H={"aria-hidden":"true"},z={key:0,class:"form__field"},Q={key:1,class:"error"},X=["disabled"],Z={key:0},tt={key:1},et={class:"dictionary-side"},nt={class:"suggestions dictionary-card"},ot={class:"chips"},st=["onClick"],it={key:0,class:"recent dictionary-card"},at={"aria-hidden":"true"},lt={key:0},rt=["onClick"],ut={key:0},ct={key:0,class:"dictionary-dialog",open:""},dt=L({__name:"DictionarySearchView",setup(ht){const y=$(),p=r(""),_=r(""),h=r(!1),c=r(""),g=r(!1),v=r(!1),m=r(!0),f=r([]),a=M([]),T=()=>{h.value=!h.value},R=()=>{m.value=!m.value},E=()=>{v.value=!1},V=()=>{typeof window>"u"||localStorage.setItem(N,JSON.stringify(a))},k=()=>{const i=[...G];i.sort(()=>Math.random()-.5),f.value=i.slice(0,6)},b=(i,e)=>{const n=new URLSearchParams({keyword:i});e&&n.set("context",e),y.push(`/dictionary/result?${n.toString()}`).finally(()=>{g.value=!1})},A=()=>{if(!p.value.trim())return;const i=p.value.trim(),e=_.value.trim();if(i.length>30){c.value="Từ khóa không được vượt quá 30 ký tự.";return}if(e&&e.length>i.length*5){c.value="Ngữ cảnh không nên dài hơn 5 lần từ khóa.";return}g.value=!0;const n=new URLSearchParams({keyword:i});e&&n.set("context",e);const l=a.findIndex(D=>D.keyword===i);l!==-1&&a.splice(l,1),a.unshift({keyword:i,context:e}),a.length>5&&a.splice(5),V(),y.push(`/dictionary/result?${n.toString()}`)};return O(()=>{if(!K()){y.replace("/");return}k(),localStorage.getItem(I.dictionary)||(v.value=!0,localStorage.setItem(I.dictionary,"true"));const e=localStorage.getItem(N);if(e)try{const l=JSON.parse(e);a.splice(0,a.length,...l)}catch(l){console.error("Cannot load dictionary history",l)}P().fullName||(v.value=!0),window.setTimeout(()=>{g.value=!1},200)}),(i,e)=>(s(),o("div",F,[U(B),t("main",J,[e[9]||(e[9]=t("header",{class:"hero dictionary-card"},[t("div",{class:"hero__icon"},"AI"),t("div",{class:"hero__content"},[t("h1",null,"Từ điển thông minh"),t("p",null,"Tra cứu từ vựng, thành ngữ và câu mẫu với giải thích theo ngữ cảnh.")])],-1)),t("div",W,[t("form",{class:"lookup-card dictionary-card",onSubmit:Y(A,["prevent"])},[e[6]||(e[6]=t("header",{class:"lookup-card__header"},[t("h2",null,"Tra cứu nhanh"),t("p",null,"Nhập từ khóa và thêm ngữ cảnh để nhận giải thích rõ ràng hơn.")],-1)),t("label",j,[e[4]||(e[4]=t("span",null,"Từ khóa",-1)),S(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>p.value=n),type:"text",required:"",maxlength:"30",placeholder:"Nhập từ hoặc cụm từ...",onInput:e[1]||(e[1]=n=>c.value="")},null,544),[[w,p.value]])]),t("button",{class:"toggle",type:"button",onClick:T},[t("span",null,u(h.value?"Ẩn ngữ cảnh":"Thêm ngữ cảnh"),1),t("span",H,u(h.value?"-":"+"),1)]),h.value?(s(),o("label",z,[e[5]||(e[5]=t("span",null,"Ngữ cảnh",-1)),S(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=n=>_.value=n),rows:"3",placeholder:"Mô tả câu, đoạn văn hoặc tình huống bạn đang tìm hiểu",onInput:e[3]||(e[3]=n=>c.value="")},null,544),[[w,_.value]])])):d("",!0),c.value?(s(),o("p",Q,u(c.value),1)):d("",!0),t("button",{class:"submit",type:"submit",disabled:g.value},[g.value?(s(),o("span",Z,"Đang tra cứu...")):(s(),o("span",tt,"Tra cứu"))],8,X)],32),t("aside",et,[t("section",nt,[t("header",null,[e[7]||(e[7]=t("h2",null,"Gợi ý tra cứu",-1)),t("button",{type:"button",onClick:k},"Làm mới")]),t("div",ot,[(s(!0),o(x,null,C(f.value,n=>(s(),o("button",{key:n,class:"chip",type:"button",onClick:l=>b(n)},u(n),9,st))),128))])]),a.length?(s(),o("section",it,[t("header",{onClick:R},[e[8]||(e[8]=t("h2",null,"Tìm kiếm gần đây",-1)),t("span",at,u(m.value?"-":"+"),1)]),m.value?(s(),o("ul",lt,[(s(!0),o(x,null,C(a,n=>(s(),o("li",{key:n.keyword},[t("button",{type:"button",onClick:l=>b(n.keyword,n.context)},[t("strong",null,u(n.keyword),1),n.context?(s(),o("small",ut,u(n.context),1)):d("",!0)],8,rt)]))),128))])):d("",!0)])):d("",!0)])])]),v.value?(s(),o("dialog",ct,[t("div",{class:"dictionary-dialog__content"},[e[10]||(e[10]=t("h2",null,"Lần đầu sử dụng?",-1)),e[11]||(e[11]=t("p",null,"AI Tutor giúp bạn hiểu nghĩa của từ trong ngữ cảnh thực tế.",-1)),e[12]||(e[12]=t("ul",null,[t("li",null,"Nhập từ khóa bằng tiếng Anh để tra cứu."),t("li",null,"Thêm ngữ cảnh bằng tiếng Việt hoặc Anh để có kết quả chính xác hơn."),t("li",null,"Lưu lại những từ quan trọng trong ghi chú riêng của bạn.")],-1)),t("button",{type:"button",onClick:E},"Bắt đầu")])])):d("",!0)]))}}),mt=q(dt,[["__scopeId","data-v-daced398"]]);export{mt as default};
